@model Car_Rental_Management.ViewModels.EditProfileViewModel
@{
    ViewData["Title"] = "Edit Profile";
    Layout = "_CustomerLayout";
}

<div class="card shadow-lg p-4" style="max-width: 650px; margin:auto; margin-top:50px;">
    <h3 class="text-center mb-4">✏️ Edit Profile</h3>

    <form asp-action="EditProfile" asp-controller="Account" method="post" enctype="multipart/form-data">
        @Html.AntiForgeryToken()
        <input type="hidden" asp-for="UserId" />

        <div class="text-center mb-3">
            <img id="profilePreview"
                 src="@(string.IsNullOrEmpty(Model.ProfileImageUrl) ? "/images/default-profile.png" : Model.ProfileImageUrl)"
                 class="rounded-circle mb-2"
                 width="120"
                 height="120"
                 style="object-fit:cover; border:2px solid #2563EB;" />

            <input asp-for="ProfileImage" type="file" class="form-control mt-2" accept="image/*" />
        </div>

        <div class="mb-3">
            <label asp-for="FullName" class="form-label"></label>
            <input asp-for="FullName" class="form-control" />
            <span asp-validation-for="FullName" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="Email" class="form-label"></label>
            <input asp-for="Email" class="form-control" />
            <span asp-validation-for="Email" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label asp-for="PhoneNumber" class="form-label"></label>
            <input asp-for="PhoneNumber" class="form-control" />
            <span asp-validation-for="PhoneNumber" class="text-danger"></span>
        </div>

        <button type="submit" class="btn btn-success w-100">Save Changes</button>
    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        const fileInput = document.querySelector('input[name="ProfileImage"]');
        const previewImg = document.getElementById('profilePreview');

        fileInput.addEventListener('change', function (e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (event) {
                    previewImg.src = event.target.result;
                }
                reader.readAsDataURL(file);
            }
        });
    </script>
}
